import json
from web3 import Web3
import hashlib
ganache_url="http://127.0.0.1:7545"

web3=Web3(Web3.HTTPProvider(ganache_url))
web3.eth.defaultAccount=web3.eth.accounts[0]
abi=json.loads('[{"constant":false,"inputs":[{"internalType":"address","name":"owneradd","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"}],"name":"acceptloan","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"add","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"depositCrypto","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"getasingleloandetail","outputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"add","type":"address"}],"name":"getavailcrypto","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"getloanpayableamount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"loanMap","outputs":[{"internalType":"address","name":"borrower","type":"address"},{"internalType":"enum Bank.ProposalState","name":"state","type":"uint8"},{"internalType":"uint256","name":"dueDate","type":"uint256"},{"internalType":"uint256","name":"numberofdays","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"collected","type":"uint256"},{"internalType":"uint256","name":"startDate","type":"uint256"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"rate","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"loanlist","outputs":[{"internalType":"address","name":"borrower","type":"address"},{"internalType":"enum Bank.ProposalState","name":"state","type":"uint8"},{"internalType":"uint256","name":"dueDate","type":"uint256"},{"internalType":"uint256","name":"numberofdays","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"collected","type":"uint256"},{"internalType":"uint256","name":"startDate","type":"uint256"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"rate","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"senderid","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"numberofdays","type":"uint256"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"rate","type":"uint256"}],"name":"newLoan","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"owneradd","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"}],"name":"rejectloan","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"internalType":"address","name":"owner1","type":"address"}],"name":"totalloanlength","outputs":[{"internalType":"int256","name":"","type":"int256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"internalType":"address","name":"add","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"withdrawCrypto","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"}]')
bytecode='608060405234801561001057600080fd5b50610ef2806100206000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c80636373bc58116100715780636373bc58146102ce578063653655981461035157806390d9a0c714610405578063975813a614610471578063ea6064e4146104bf578063f42e845714610501576100a9565b8063077cada1146100ae57806307bf1896146101065780631594a313146101545780633dcc1870146102285780634728ef6c14610276575b600080fd5b6100f0600480360360208110156100c457600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919050505061054f565b6040518082815260200191505060405180910390f35b6101526004803603604081101561011c57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919050505061059a565b005b6101a06004803603604081101561016a57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050610711565b604051808a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018960038111156101e257fe5b60ff168152602001888152602001878152602001868152602001858152602001848152602001838152602001828152602001995050505050505050505060405180910390f35b6102746004803603604081101561023e57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291905050506107a6565b005b6102b86004803603602081101561028c57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291905050506107f7565b6040518082815260200191505060405180910390f35b6102fa600480360360208110156102e457600080fd5b8101908080359060200190929190505050610840565b604051808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200184815260200183815260200182815260200194505050505060405180910390f35b61037d6004803603602081101561036757600080fd5b81019080803590602001909291905050506108d1565b604051808a73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018960038111156103bf57fe5b60ff168152602001888152602001878152602001868152602001858152602001848152602001838152602001828152602001995050505050505050505060405180910390f35b61046f600480360360a081101561041b57600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff1690602001909291908035906020019092919080359060200190929190803590602001909291908035906020019092919050505061094c565b005b6104bd6004803603604081101561048757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050610c1c565b005b6104eb600480360360208110156104d557600080fd5b8101908080359060200190929190505050610c6d565b6040518082815260200191505060405180910390f35b61054d6004803603604081101561051757600080fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff16906020019092919080359060200190929190505050610d45565b005b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020805490509050919050565b60008090505b6000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020805490508110156106d557816000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020828154811061063357fe5b90600052602060002090600802016006015414156106c85760016000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020828154811061069657fe5b906000526020600020906008020160000160146101000a81548160ff021916908360038111156106c257fe5b02179055505b80806001019150506105a0565b50600180600083815260200190815260200160002060000160146101000a81548160ff0219169083600381111561070857fe5b02179055505050565b6000602052816000526040600020818154811061072a57fe5b9060005260206000209060080201600091509150508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060010154908060020154908060030154908060040154908060050154908060060154908060070154905089565b80600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505050565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b6000806000806001600086815260200190815260200160002060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1660016000878152602001908152602001600020600201546001600088815260200190815260200160002060030154600160008981526020019081526020016000206004015493509350935093509193509193565b60016020528060005260406000206000915090508060000160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060000160149054906101000a900460ff16908060010154908060020154908060030154908060040154908060050154908060060154908060070154905089565b60004290506000620151808502820190506000808873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206040518061012001604052803373ffffffffffffffffffffffffffffffffffffffff168152602001600060038111156109d057fe5b815260200183815260200187815260200188815260200160008152602001848152602001868152602001858152509080600181540180825580915050906001820390600052602060002090600802016000909192909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160000160146101000a81548160ff02191690836003811115610a9457fe5b021790555060408201518160010155606082015181600201556080820151816003015560a0820151816004015560c0820151816005015560e0820151816006015561010082015181600701555050506040518061012001604052803373ffffffffffffffffffffffffffffffffffffffff16815260200160006003811115610b1857fe5b815260200182815260200186815260200187815260200160008152602001838152602001858152602001848152506001600086815260200190815260200160002060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160000160146101000a81548160ff02191690836003811115610bc457fe5b021790555060408201518160010155606082015181600201556080820151816003015560a0820151816004015560c0820151816005015560e08201518160060155610100820151816007015590505050505050505050565b80600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055505050565b600080426001600085815260200190815260200160002060010154031215610d2657600060016000848152602001908152602001600020600101544203905060006301e185588281610cbb57fe5b049050600181019050600060648260016000888152602001908152602001600020600701546001600089815260200190815260200160002060030154020281610d0057fe5b049050806001600087815260200190815260200160002060030154019350505050610d40565b600160008381526020019081526020016000206003015490505b919050565b60008090505b6000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002080549050811015610e8057816000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208281548110610dde57fe5b9060005260206000209060080201600601541415610e735760036000808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208281548110610e4157fe5b906000526020600020906008020160000160146101000a81548160ff02191690836003811115610e6d57fe5b02179055505b8080600101915050610d4b565b5060036001600083815260200190815260200160002060000160146101000a81548160ff02191690836003811115610eb457fe5b0217905550505056fea265627a7a723158201ef22cbef1f93700d45b979e1d6f382aaf956eff2ed0774e2f02083f4ef559bf64736f6c63430005110032'

Bank = web3.eth.contract(abi=abi,bytecode=bytecode)

tx_hash=Bank.constructor().transact()
print(tx_hash)

tx_receipt= web3.eth.waitForTransactionReceipt(tx_hash)

print(tx_receipt)

# contract1=web3.eth.contract(
#     address="0xb7a4D43440Ac72f4B675f747818003373632405c",
    
#     abi=abi
# )

# print(contract1.functions.depositCrypto("0x7259ccf5EF1e20410e0C1d859a6dde6D61C829CF",20).transact())

# print(contract1.functions.buy_obsidians("0x7259ccf5EF1e20410e0C1d859a6dde6D61C829CF",50).transact())
# print(contract1.functions.equity_in_obsidian("0x7259ccf5EF1e20410e0C1d859a6dde6D61C829CF").call())
